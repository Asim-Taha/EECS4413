{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/app/auth/session.ts"],"sourcesContent":["'use server'\n\nimport { cookies } from \"next/headers\";\nimport { redirect } from \"next/navigation\";\n\nconst BACKEND_URL = process.env.NEXT_PUBLIC_BACKEND_URL\n\nconst cookie = {\n    name: 'session',\n    options: {httpOnly: true, secure: true, sameSite: 'lax' as const, path:'/'},\n    duration: 1 * 60 * 60 * 1000, // 1hr \n}\n\nexport async function createSession(token : string){\n    const expires = new Date(Date.now() + cookie.duration);\n    //used after user login or signup \n    (await cookies()).set(cookie.name,token,{...cookie.options, expires})\n    \n    redirect('/dashboard')\n}\n\nexport async function verifySession() {\n    const token = (await cookies()).get(\"session\")?.value;\n  \n    try {\n      const response = await fetch(`${BACKEND_URL}/auth/verify-token`, {\n        method: \"POST\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n        credentials: \"include\",\n      });\n  \n      if (!response.ok) {\n        return null; // ‚úÖ Don't redirect ‚Äî let middleware handle it\n      }\n  \n      const data = await response.json();\n      return data.user;\n    } catch (error) {\n      console.error(\"‚ùå verifySession error:\", error);\n      return null; // ‚úÖ Just return null on failure\n    }\n  }\n\nexport async function deleteSession() {\n    (await cookies()).delete(cookie.name)\n    redirect('/login')\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AADA;AACA;AAHA;;;AAKA,MAAM;AAEN,MAAM,SAAS;IACX,MAAM;IACN,SAAS;QAAC,UAAU;QAAM,QAAQ;QAAM,UAAU;QAAgB,MAAK;IAAG;IAC1E,UAAU,IAAI,KAAK,KAAK;AAC5B;AAEO,eAAe,cAAc,KAAc;IAC9C,MAAM,UAAU,IAAI,KAAK,KAAK,GAAG,KAAK,OAAO,QAAQ;IACrD,kCAAkC;IAClC,CAAC,MAAM,CAAA,GAAA,mKAAA,CAAA,UAAO,AAAD,GAAG,EAAE,GAAG,CAAC,OAAO,IAAI,EAAC,OAAM;QAAC,GAAG,OAAO,OAAO;QAAE;IAAO;IAEnE,CAAA,GAAA,uKAAA,CAAA,WAAQ,AAAD,EAAE;AACb;AAEO,eAAe;IAClB,MAAM,QAAQ,CAAC,MAAM,CAAA,GAAA,mKAAA,CAAA,UAAO,AAAD,GAAG,EAAE,GAAG,CAAC,YAAY;IAEhD,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,YAAY,kBAAkB,CAAC,EAAE;YAC/D,QAAQ;YACR,SAAS;gBACP,eAAe,CAAC,OAAO,EAAE,OAAO;YAClC;YACA,aAAa;QACf;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,OAAO,MAAM,8CAA8C;QAC7D;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,OAAO,KAAK,IAAI;IAClB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,MAAM,gCAAgC;IAC/C;AACF;AAEK,eAAe;IAClB,CAAC,MAAM,CAAA,GAAA,mKAAA,CAAA,UAAO,AAAD,GAAG,EAAE,MAAM,CAAC,OAAO,IAAI;IACpC,CAAA,GAAA,uKAAA,CAAA,WAAQ,AAAD,EAAE;AACb"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["turbopack://[project]/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { verifySession } from \"@/app/auth/session\";\nimport { cookies } from \"next/headers\";\n\nexport default async function middleware(request: NextRequest) {\n  const currentPath = request.nextUrl.pathname;\n  const isProtectedRoute = currentPath.startsWith('/dashboard');\n  const isAuthPage = currentPath.startsWith('/login') || currentPath.startsWith('/signup');\n\n  console.log(\"üìç Middleware executing:\", request.nextUrl.pathname);\nconst session = await verifySession();\nconsole.log(\"üì¶ Middleware session:\", session);\n\n\n  // üîê Block access to protected routes if not logged in\n  if (isProtectedRoute && !session?.name) {\n    return NextResponse.redirect(new URL('/login', request.url));\n  }\n\n  // ‚õî Redirect logged-in users away from auth pages\n  if (session?.name && isAuthPage) {\n    return NextResponse.redirect(new URL('/dashboard', request.url));\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: ['/dashboard/:path*', '/login/:path*', '/signup/:path*'],\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AADA;;;AAIe,eAAe,WAAW,OAAoB;IAC3D,MAAM,cAAc,QAAQ,OAAO,CAAC,QAAQ;IAC5C,MAAM,mBAAmB,YAAY,UAAU,CAAC;IAChD,MAAM,aAAa,YAAY,UAAU,CAAC,aAAa,YAAY,UAAU,CAAC;IAE9E,QAAQ,GAAG,CAAC,4BAA4B,QAAQ,OAAO,CAAC,QAAQ;IAClE,MAAM,UAAU,MAAM,CAAA,GAAA,sHAAA,CAAA,gBAAa,AAAD;IAClC,QAAQ,GAAG,CAAC,0BAA0B;IAGpC,uDAAuD;IACvD,IAAI,oBAAoB,CAAC,SAAS,MAAM;QACtC,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC5D;IAEA,kDAAkD;IAClD,IAAI,SAAS,QAAQ,YAAY;QAC/B,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;IAChE;IAEA,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;QAAiB;KAAiB;AACnE"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}